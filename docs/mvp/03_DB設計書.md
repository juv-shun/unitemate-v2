# DB 設計

## テーブル一覧

| テーブル名 | 説明           |
| ---------- | -------------- |
| users      | ユーザー情報   |
| matches    | マッチング情報 |

## テーブル設計

### users

- **プライマリキー (PK):** `user_id`
- **グローバルセカンダリインデックス (GSI):** `Auth0SubIndex` (パーティションキー: `auth0_sub`)

| 項目名                 | 型     | 説明                                                                                 |
| :--------------------- | :----- | :----------------------------------------------------------------------------------- |
| **user_id (PK)**       | string | ユーザーのプライマリキー。Auth0 の`sub`クレーム（Discord のネイティブ ID）と同じ値。 |
| **auth0_sub (GSI PK)** | string | Auth0 のユーザー識別子。GSI `Auth0SubIndex`のパーティションキー。                    |
| discord_username       | string | Discord のユーザー名。                                                               |
| discord_discriminator  | string | Discord の識別子（例: #1234）。新しいユーザー名形式では null になる可能性がある。    |
| discord_avatar_url     | string | Discord のアバター画像の URL。                                                       |
| app_username           | string | アプリケーション内で使用されるユーザー名。初期値は Discord のユーザー名。            |
| created_at             | string | レコード作成日時 (ISO 8601 形式)。                                                   |
| updated_at             | string | レコード最終更新日時 (ISO 8601 形式)。                                               |

### matches

| 項目名       | 型     | 説明                                                                       |
| ------------ | ------ | -------------------------------------------------------------------------- |
| match_id     | string | マッチング ID                                                              |
| matched_at   | number | マッチング日時                                                             |
| status       | string | マッチング状態                                                             |
| winner       | string | 勝利チーム                                                                 |
| users        | map    | ユーザー情報                                                               |
| user_reports | list   | ユーザーからの試合報告(users に含まれるユーザー 10 人分から報告されるはず) |

#### matches/users

| 項目名 | 型   | 説明                          |
| ------ | ---- | ----------------------------- |
| teamA  | list | チーム A のユーザー情報(5 人) |
| teamB  | list | チーム B のユーザー情報(5 人) |

#### matches/users/teamA (teamB)

| 項目名  | 型     | 説明        |
| ------- | ------ | ----------- |
| user_id | string | ユーザー ID |
| rate    | number | レート      |

#### matches/user_reports

| 項目名  | 型     | 説明                    |
| ------- | ------ | ----------------------- |
| user_id | string | ユーザー ID             |
| team    | string | チーム (teamA or teamB) |
| result  | string | 勝敗                    |
| pokemon | string | 使用ポケモン            |
