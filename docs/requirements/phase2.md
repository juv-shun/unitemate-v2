# フェーズ2要件: 勝敗報告・多数決判定

## 1. 目的
試合終了後に参加者が結果を報告し、多数決により勝敗を確定する。
未入力ユーザーがいても確定できる仕組みを提供し、早期確定を優先する。

---

## 2. 用語
- **報告**: 参加者が「勝利 / 敗北 / 無効」のいずれかを入力する行為
- **確定**: システムが多数決で結果を確定すること
- **マッチ時刻**: マッチング成立時刻（matches.created_at）

---

## 3. 対象ユーザー
- マッチに参加したユーザー（participant）

---

## 4. 入力仕様
- 入力値: 勝利 / 敗北 / 無効
- 入力は**再入力（上書き）を許可**する
- 全員が入力しないケースを許容する

---

## 5. 勝敗確定ロジック
### 5.1 即時確定（7票ルール）
- 有効票が **7票以上** 集まった時点で即時確定
- 7票時点の多数決で確定
- 同数の場合は **無効** とする

### 5.2 タイムアウト確定（40分ルール）
- マッチ時刻から **40分** 経過時点で強制確定
- その時点の最多票で確定
- 同数の場合は **無効** とする

---

## 6. 未入力ユーザーへの対応
- 未入力ユーザーがいても確定できる
- 40分経過後は未入力が残っていても確定する

---

## 7. 例外・注意
- 同数は常に **無効**
- 参加者以外（spectator）の入力は対象外
